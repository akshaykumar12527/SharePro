<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
  <title>Testing Module</title>
  <meta name="author" content="Akshay Kumar">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Font CSS (Via CDN) -->
  <link rel='stylesheet' type='text/css' href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700'>

  <!-- Theme CSS -->
  <link rel="stylesheet" type="text/css" href="assets/skin/default_skin/css/theme.css">
  <!-- Glyphicons Pro CSS(font) -->
  <link rel="stylesheet" type="text/css" href="assets/fonts/glyphicons-pro/glyphicons-pro.css">

  <!-- Icomoon CSS(font) -->
  <link rel="stylesheet" type="text/css" href="assets/fonts/icomoon/icomoon.css">

  <!-- Iconsweets CSS(font) -->
  <link rel="stylesheet" type="text/css" href="assets/fonts/iconsweets/iconsweets.css">

  <!-- Octicons CSS(font) -->
  <link rel="stylesheet" type="text/css" href="assets/fonts/octicons/octicons.css">

  <!-- Stateface CSS(font) -->
  <link rel="stylesheet" type="text/css" href="assets/fonts/stateface/stateface.css">

  <!-- Favicon -->
  <link rel="shortcut icon" href="assets/img/favicon.ico">
  <style>
  #hs-rsp-popup-bg {
    position: fixed;
    top: 0px;
    left: 0px;
    width: 100%;
    height: 100%;
    background: transparent url("overlay-bg.png")  scroll 0px 0px;
    z-index: 9998;
    
}
#hs-rsp-image-wrap {
    position: absolute;
    background-color: #FFF;
    padding: 10px;
}
#hs-rsp-image-loader {
    position: absolute;
    width: 100px;
    height: 100px;
    background: transparent url("ajax-loader.gif") no-repeat scroll center center;
    margin-left: -30px;
}
.welcome-text {
    
    padding: 0px 30px;
    margin: 15px 0px 0px;
    overflow: hidden;
}
.welcome-text > h1 {
    margin-top: 110px;
    margin-bottom: 0px;
}
.title_style {
    color: #0091FF;
    font-family: Raleway,Arial,sans-serif;
    font-size: 105px;
    line-height: 1;
    font-weight: 500;
}
.description_style {
    color: #777;
    font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
    font-weight: 600;
    font-size: 22px;
}
.welcome-text > p {
    padding: 50px 0px 60px;
    margin-bottom: 0px;
}
.welcome-text #start_system_check {
    border-radius: 4px;
    color: #FFF;
    font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
    font-size: 22px;
    background-color: #0091FF;
    padding: 20px 60px;
    margin: 0px;
}
  </style>
</head>

<body class="blank-page">

  
  <!-- Start: Main -->
  <div id="main">

    <!-- Start: Header -->
  <header class="navbar navbar-fixed-top bg-info" style="height:100px;padding: 5px;">
<div class="navbar-branding" style="height:100%;width:100%">
<div class="row">
<div class="col-md-2">
<img src="assets/img/logos/KVApp.png" class="logo" height="90px" width="90px"></img>
</div>
<div class="col-md-2">
 <img src="assets/img/logos/Video-icon.png" class="logo" height="90px" width="90px"></img>
   
</div>
<div class="col-md-2">
<img src="assets/img/logos/video-icon_3.png" class="logo" height="90px" width="90px"></img>
</div>
<div class="col-md-2">
 <img src="assets/img/logos/Video-icon.png" class="logo" height="90px" width="90px"></img>
   
</div>
<div class="col-md-2">
<img src="assets/img/logos/KVApp.png" class="logo" height="90px" width="90px"></img>
</div>
<div class="col-md-2">
 <img src="assets/img/logos/video-icon_3.png" class="logo" height="90px" width="90px"></img>
   
</div>
</div>
   
  </div>
</header>
  
  <div class="content-wrapper" style="margin-top:110px">
<div class="row">
<div class="col-xs-6 ">
 <ul class="nav navbar-nav ">
            
                <li id="my_library">
                    <a href="#">My Library</a>
                </li>
            
                <li id="feedback">
                    <a href="#">Feedback</a>
                </li>
            
                <li id="support">
                    <a href="#">Support</a>
                </li>
            
                <li id="logout">
                    <a href="#">Logout</a>
                </li>
            
        </ul>
    </div>
  <div class="col-xs-6 pull-right">
    <button disabled class="btn btn-primary pull-right" id="preview"><i class="fa fa-eye"></i> Preview</button>
    </div>
  </div>
<div class="row">
<div class="col-lg-3" style="border: 1px solid;">
<div class="panel">
 <div class="panel-heading">
<span class="panel-title">Slides</span>
</div>
<div class="panel-body panel-scroller scroller-sm scroller-pn pn scroller scroller-active" style="min-height: 400px;">
<div style="height: 199px;" class="scroller-bar">
<div style="height: 189px; margin-bottom: 5px; margin-top: 5px;" class="scroller-track">
<div style="height: 74.8868px; top: 1px;" class="scroller-handle">
</div></div></div>
<div class="scroller-content">
<ul class="slides list-group">

</ul>
 </div>
 </div>
  </div>
<!-- <div class="slides-container scroller" style="max-height: 400px;
overflow: scroll;" >

</div>
-->
</div>
<div class="col-lg-6" id="selected_slide" style="border: 1px solid;">

</div>
<div class="col-lg-3" style="border: 1px solid;">
<div class="row">
<div class="col-xs-12">
<i class="fa fa-lg fa-video-camera " ></i>
<video src=""  height="300" width="300" ></video>
</div>
</div>
<div class="row" style="margin-top: 25px; margin-bottom: 25px;">
  <div class="col-xs-12" style="text-align: center;" >
   <strong style="font-size: 20px;"> <span id="time_span">00:00</span><strong>
    </strong></strong></div>
    </div> 
    <div class="row">
<div style="text-align: center;" class="col-xs-4">
<button style="border-radius: 50%; border: 2px solid white; font-size: 30px;" class="btn btn-lg btn-success" id="btn-start-recording"><span class="fa fa-lg fa-microphone"></span></button>
</div>
<div style="text-align: center;" class="col-xs-4">
<button style="border-radius: 50%; border: 2px solid white; font-size: 30px;" disabled class="btn btn-lg btn-success" id="btn-stop-recording"><span class="fa fa-lg fa-microphone-slash"></span></button>
</div>
<!-- <div style="text-align: center;" class="col-xs-4 ">
<button style="border-radius: 50%; border: 2px solid white; font-size: 30px;" class="btn btn-lg btn-success" id="next-slide"><i class="fa fa-lg fa-step-forward"></i></button>
</div>-->
</div>
</div>
</div>
</div>
<div style="display: block;" class="modal fade in" id="recent_slides_modal" tabindex="-1" aria-hidden="false" data-keyboard="false">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
         
          <h4 class="modal-title">Add Slides</h4>
        </div>
        <div class="modal-body">
          <div class="row">
			<div class="col-xs-12 text-center">
            <div style="border: 2px dashed rgb(187, 187, 187); margin: 15px 11px;" class="knovio-modal-upload-container">

                <div style="position: relative; max-width: 160px; margin: 80px auto; overflow: hidden;" class="upload-slides-btn-wrapper">
                    <span style="border: 1px solid rgb(0, 145, 255); cursor: pointer; border-radius: 5px; text-align: center; padding: 15px 5px; color: rgb(0, 145, 255); display: block; max-width: 160px; width: 100%; font-size: 16px; line-height: 1;" class="btn btn-default upload-slides-btn">
                        <span>Upload Slides</span>
                        <form id="uploadForm" action="upload" method="post" enctype="multipart/form-data">
                        <input style="position: absolute; top: 0px; right: 0px; margin: 0px; opacity: 0; font-size: 9px; cursor: pointer; color: rgb(255, 255, 255); height: 48px;" id="select_upload_slides" name="select_upload_slides" accept="application/vnd.ms-powerpoint, application/vnd.openxmlformats-officedocument.presentationml.presentation, application/pdf,application/x-pdf,application/acrobat,applications/vnd.pdf,text/pdf,text/x-pdf, image/png, image/jpeg, image/gif" multiple="" type="file">
                   		</form>
                    </span>
                </div>
            </div>
        </div>
    </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal" id='close'>Close</button>
        </div>
      </div>
      
    </div>
    
  </div>
<div style="display: block;" class="modal fade in" id="welcome" tabindex="-1" aria-hidden="false" data-keyboard="false">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
     
        <div class="modal-body">
          <div class="row">
			<div class="col-xs-12 text-center">
            <div class="text-center welcome-text">
                    <h1 class="title_style">Welcome!</h1>
                    <p class="description_style">Let's check that you are set up to record<br class="visible-md-inline visible-lg-inline"> with your camera and microphone</p>
                   	
                    <span id="start_system_check" class="btn btn-info btn-lg">Start</span>
                </div>
        </div>
    </div>
        </div>
        
      </div>
      
    </div>
    
  </div>

  <div id='preview_modal' class="modal fade" role="dialog">
   <div class="modal-dialog">
<div class="modal-content" data-keyboard="false" data-backdrop="static" >

        <div class="row">
            <div class="modal-header">
                <div class="col-xs-12">
                    <h4 class="knovio-modal-header-title">Preview Changes</h4>
                </div>
            </div>
        </div>

        <div class="row pad10">
            <div class="col-sm-12 text-center">
                <div class="preview-text-content">A preview of your presentation will open in a new browser window.</div>
            </div>
        </div>
        <div class="row pad10">
            <div class="col-sm-12">
                <div class="pull-right preview-footer-wrap">
                    <button class="btn btn-default btn-cancel preview-cancel"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <a class="btn btn-primary launch-preview ml5" href="/preview.html" id='preview_link' ><span class="glyphicon glyphicon-play"></span> Launch Preview</a>
                </div>
            </div>
        </div>
    </div>
   </div>
   </div>
  </div>
   <!-- End: Main -->
<div id="hs-rsp-popup-bg"><div style="visibility: hidden;" id="hs-rsp-image-wrap"><a id="hs-rsp-close" href="#hs-rsp-close" title="click to close">Close</a><img id="hs-rs-big-img" src="http://cdn.hayageek.com/wp-content/uploads/2015/03/image1.png" alt="http://cdn.hayageek.com/wp-content/uploads/2015/03/image1.png"></div><div style="left: 658px; top: 192px;" id="hs-rsp-image-loader"></div></div>
  <!-- BEGIN: PAGE SCRIPTS -->

  <!-- jQuery -->
  <script src="vendor/jquery/jquery-1.11.1.min.js"></script>
  <script src="vendor/jquery/jquery_ui/jquery-ui.min.js"></script>

  <!-- Theme Javascript -->
  <script src="assets/js/utility/utility.js"></script>
<script src="vendor/jquery/jquery.form.min.js"></script>
  <script src="assets/js/main.js"></script>
  <script src="vendor/DetectRTC.js"></script>
  <script src="vendor/RecordRTC.js"></script>
  <script src="javascript/recording.js"></script>
 <script src="javascript/test_media.js"></script>
  <script src="vendor/jquerysession.js"></script>
  <script type="text/javascript">
  $(document).ready(function() {
	  var i=0;
	  var prevSlide='';
	  var prev=-1;
	 /* if(DetectRTC.hasMicrophone){
		  if(DetectRTC.hasWebcam){
			  
		  }
		  else{
			  $(".fa-video-camera").attr("class","fa fa-lg fa-video-camera");
		  }
	  }*/
	  $("#start_system_check").click(function(){
		detect();
		
			$("#welcome").fadeOut();
		  $("#recent_slides_modal").modal();
		  
		
		  
	  });
	  $("#hs-rsp-popup-bg").fadeOut();
	  $.post('getsession',function(data,status){
		 // alert(data.username);
		 $.sesstion.set('session',data);
		  console.log(data);
		 
	  });
	 
	  $("#select_upload_slides").change(function()
			{
		alert("selected");
		$("#uploadForm").trigger("submit");
			});
	     $('#uploadForm').submit(function() {
			
	        $(this).ajaxSubmit({
	        	beforeSubmit:function(){
	        		$("#hs-rsp-popup-bg").fadeIn();
	        	},

	            error: function(xhr) {
	                    status('Error: ' + xhr.status);
	                    $("#hs-rsp-popup-bg").fadeOut();
	                    alert('error');
	            },

	            success: function(response) {
	            	 $("#recent_slides_modal").fadeOut();           			
	            	 $("#hs-rsp-popup-bg").fadeOut();  
						
	                      for(var i=0;i<response.slides.length;i++){
	            	var li=document.createElement("li");
	            	li.innerHTML='<img src="'+response.slides[i]+'" class="img-preview" />';
	           		//slides=response.slides;
	            		$(".slides").append(li);	
	            	
	            	
	                      }
	            }
	            
	            
	    });
	        //Very important line, it disable the page refresh.
	    return false;
	    });
	    $(document).on('click','img',function(){
	    	 if($(this).attr('src')>prevSlide || $(this).attr('src').length>prevSlide.length)
	    		 {
	    		 prev++;
	    		 var slide={};
	    		 slide.path=$(this).attr('src');
	    		 slide.start_time=duration;
	    		/* if(prev>0)
	    			 {
	    			 slides[prev-1].end_time=duration;
	    			 alert('end time='+slides[prev-1].end_time);
	    			 }*/
	    		 slides[prev]=slide;
	    	 $("#selected_slide").html('<img src="'+$(this).attr("src")+'" class="img-container" />');
	    	 prevSlide=$(this).attr('src');
	    	 console.log(duration+' '+slides.length);
	    	 //alert(prev+"  "+slides[0].path+"  "+slides[0].start_time+"  "+slides[0].end_time);
	    	 
	    		 }
	    	 else{
	    	 console.log($(this).attr('src')+'   '+prevSlide);
	    	 }
	    	 
	     });
	     /*$("img").click(function(){
	    	 $("#selected_slide").html('<img src="'+$(this).attr("src")+'" class="img-container" />');
	     });*/
	     $('#close').on('click',function(){
	    	 for(var i=0;i<17;i++){
	            	var li=document.createElement("li");
	           	 var path='upload/appt1440838728962/appt1440838728962-'+i+'.jpg';
	            	li.innerHTML='<img src="'+path+'" class="img-preview" />';
	           		//slides=response.slides;
	            		$(".slides").append(li);	
	            	
	            	
	                      }
	    	
	     });
	     $(document).on('unload',function(){
	    	$('#preview_mpdal').fadeOut(); 
	     });
	     $('a').click(function(){
	    	 
	    	$('#preview_mpdal').fadeOut(); 
	     });
	     $("#next-slide").click(function(){
	    	 if(i<=slides.lenght)
	    		 {
	    	
	    	 $("#selected_slide").html('<img src="'+slides[i]+'" class="img-container" />');
	    	 i++;
	    		 }
	    	 else
	    		 {
	    		 $(this).attr("disable","true");
	    		 }
	     });
   
  });
  </script>
  <!-- END: PAGE SCRIPTS -->

</body>

</html>